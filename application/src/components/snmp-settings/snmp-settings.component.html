<!--
  File: src/components/snmp-settings/snmp-settings.component.html
  Project: fireCNC
  Author: Mark Dyer
  Location: Blenheim, New Zealand
  Contact: intelliservenz@gmail.com

  Description:
  Template for the SNMP Settings component. Displays settings for the SNMP agent
  and trap configurations, and provides controls for testing and configuration.
-->
<div [formGroup]="snmpForm">
  <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 gap-4">
    <h2 class="text-xl font-bold text-gray-300 flex items-center">
      <i class="fa-solid fa-cogs mr-3 text-orange-400"></i>
      SNMP Configuration
    </h2>
    <!-- REMOVED: Send Test Trap button, moved to SimulationComponent -->
    <!--
    <button type="button" (click)="sendTestTrap()" [disabled]="!snmpForm.get('TRAPS_ENABLED')?.value" class="bg-blue-500 hover:bg-blue-600 disabled:bg-blue-500/50 disabled:cursor-not-allowed text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center shadow-md">
      <i class="fa-solid fa-paper-plane mr-2"></i>
      Send Test Trap
    </button>
    -->
  </div>
  
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    
    <!-- Agent Settings Card -->
    <div class="bg-gray-900/50 p-4 rounded-lg border border-gray-700">
      <h3 class="font-bold text-gray-300 text-base mb-3 flex items-center">
        <i class="fa-solid fa-server mr-2 w-4 text-center text-orange-400"></i>
        <span>Agent Settings</span>
      </h3>
      <div class="space-y-3 font-mono text-sm">
          <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded">
          <label for="agentEnabled" class="text-gray-400">Enable Agent:</label>
          <button
            type="button"
            id="agentEnabled"
            (click)="toggleAgentAndUpdate()"
            class="relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 focus:ring-offset-gray-800"
            [class]="snmpForm.get('AGENT_ENABLED')?.value ? 'bg-orange-500' : 'bg-gray-600'"
            role="switch"
            [attr.aria-checked]="snmpForm.get('AGENT_ENABLED')?.value">
            <span
              class="pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"
              [class]="snmpForm.get('AGENT_ENABLED')?.value ? 'translate-x-5' : 'translate-x-0'">
            </span>
          </button>
        </div>
        <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded transition-opacity" [class.opacity-50]="!snmpForm.get('AGENT_ENABLED')?.value">
          <label for="community" class="text-gray-400">Community:</label>
          <input id="community" formControlName="COMMUNITY" type="text" class="bg-gray-700 border text-gray-200 text-sm rounded-lg focus:ring-orange-500 focus:border-orange-500 block p-1 font-bold font-mono text-right w-32" [class]="snmpForm.get('COMMUNITY')?.invalid && snmpForm.get('COMMUNITY')?.touched ? 'border-red-500' : 'border-gray-600'">
        </div>
        <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded transition-opacity" [class.opacity-50]="!snmpForm.get('AGENT_ENABLED')?.value">
          <label for="port" class="text-gray-400">Port:</label>
          <input id="port" formControlName="PORT" type="number" class="bg-gray-700 border text-gray-200 text-sm rounded-lg focus:ring-orange-500 focus:border-orange-500 block p-1 font-bold font-mono text-right w-24" [class]="snmpForm.get('PORT')?.invalid && snmpForm.get('PORT')?.touched ? 'border-red-500' : 'border-gray-600'">
        </div>
        <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded transition-opacity" [class.opacity-50]="!snmpForm.get('AGENT_ENABLED')?.value">
          <label for="protocol" class="text-gray-400">Protocol:</label>
          <select
            id="protocol"
            formControlName="PROTOCOL"
            class="bg-gray-700 border border-gray-600 text-gray-200 text-sm rounded-lg focus:ring-orange-500 focus:border-orange-500 block p-1 font-bold font-mono">
            @for(proto of protocols; track proto) {
              <option [value]="proto">{{ proto }}</option>
            }
          </select>
        </div>
      </div>
    </div>

    <!-- Trap Settings Card -->
    <div class="bg-gray-900/50 p-4 rounded-lg border border-gray-700">
      <h3 class="font-bold text-gray-300 text-base mb-3 flex items-center">
        <i class="fa-solid fa-broadcast-tower mr-2 w-4 text-center text-orange-400"></i>
        <span>Trap Settings</span>
      </h3>
      <div class="space-y-3 font-mono text-sm">
        <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded">
          <label for="trapsEnabled" class="text-gray-400">Enable:</label>
          <button
            type="button"
            id="trapsEnabled"
            (click)="toggleTrapsAndUpdate()"
            class="relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 focus:ring-offset-gray-800"
            [class]="snmpForm.get('TRAPS_ENABLED')?.value ? 'bg-orange-500' : 'bg-gray-600'"
            role="switch"
            [attr.aria-checked]="snmpForm.get('TRAPS_ENABLED')?.value">
            <span
              class="pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"
              [class]="snmpForm.get('TRAPS_ENABLED')?.value ? 'translate-x-5' : 'translate-x-0'">
            </span>
          </button>
        </div>

        <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded transition-opacity" [class.opacity-50]="!snmpForm.get('TRAPS_ENABLED')?.value">
          <label for="trapTarget" class="text-gray-400">Target:</label>
          <input id="trapTarget" formControlName="TRAP_TARGET" type="text" class="bg-gray-700 border text-gray-200 text-sm rounded-lg focus:ring-orange-500 focus:border-orange-500 block p-1 font-bold font-mono text-right w-40" [class]="snmpForm.get('TRAP_TARGET')?.invalid && snmpForm.get('TRAP_TARGET')?.touched ? 'border-red-500' : 'border-gray-600'">
        </div>
        <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded transition-opacity" [class.opacity-50]="!snmpForm.get('TRAPS_ENABLED')?.value">
          <label for="trapPort" class="text-gray-400">Port:</label>
          <input id="trapPort" formControlName="TRAP_PORT" type="number" class="bg-gray-700 border text-gray-200 text-sm rounded-lg focus:ring-orange-500 focus:border-orange-500 block p-1 font-bold font-mono text-right w-24" [class]="snmpForm.get('TRAP_PORT')?.invalid && snmpForm.get('TRAP_PORT')?.touched ? 'border-red-500' : 'border-gray-600'">
        </div>
          <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded transition-opacity" [class.opacity-50]="!snmpForm.get('TRAPS_ENABLED')?.value">
          <label for="trapCommunity" class="text-gray-400">Community:</label>
          <input id="trapCommunity" formControlName="TRAP_COMMUNITY" type="text" class="bg-gray-700 border text-gray-200 text-sm rounded-lg focus:ring-orange-500 focus:border-orange-500 block p-1 font-bold font-mono text-right w-32" [class]="snmpForm.get('TRAP_COMMUNITY')?.invalid && snmpForm.get('TRAP_COMMUNITY')?.touched ? 'border-red-500' : 'border-gray-600'">
        </div>
        <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded transition-opacity" [class.opacity-50]="!snmpForm.get('TRAPS_ENABLED')?.value">
          <label for="trapProtocol" class="text-gray-400">Protocol:</label>
          <select
            id="trapProtocol"
            formControlName="TRAP_PROTOCOL"
            class="bg-gray-700 border border-gray-600 text-gray-200 text-sm rounded-lg focus:ring-orange-500 focus:border-orange-500 block p-1 font-bold font-mono">
            @for(proto of protocols; track proto) {
              <option [value]="proto">{{ proto }}</option>
            }
          </select>
        </div>
          <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded transition-opacity" [class.opacity-50]="!snmpForm.get('TRAPS_ENABLED')?.value">
            <label for="trapLevel" class="text-gray-400">Level:</label>
            <select
              id="trapLevel"
              formControlName="TRAP_LEVEL"
              class="bg-gray-700 border border-gray-600 text-gray-200 text-sm rounded-lg focus:ring-orange-500 focus:border-orange-500 block p-1 font-bold font-mono">
              @for(level of logLevels; track level) {
                <option [value]="level">{{ level }}</option>
              }
            </select>
        </div>
      </div>
    </div>
  </div>
  <!-- Status Page Settings Card -->
  <div class="mt-6 bg-gray-900/50 p-4 rounded-lg border border-gray-700 hidden md:block">
    <h3 class="font-bold text-gray-300 text-base mb-3 flex items-center">
      <i class="fa-solid fa-desktop mr-2 w-4 text-center text-orange-400"></i>
      <span>Status Page</span>
    </h3>
    <div class="space-y-3 font-mono text-sm">
      <div class="flex justify-between items-center bg-gray-800/50 p-2 rounded">
        <label for="displayOid" class="text-gray-400">Display OID on Status Page:</label>
        <button
          type="button"
          id="displayOid"
          (click)="toggleDisplayOidAndUpdate()"
          class="relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 focus:ring-offset-gray-800"
          [class]="snmpForm.get('DISPLAY_OID_ON_STATUS_PAGE')?.value ? 'bg-orange-500' : 'bg-gray-600'"
          role="switch"
          [attr.aria-checked]="snmpForm.get('DISPLAY_OID_ON_STATUS_PAGE')?.value">
          <span
            class="pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"
            [class]="snmpForm.get('DISPLAY_OID_ON_STATUS_PAGE')?.value ? 'translate-x-5' : 'translate-x-0'">
          </span>
        </button>
      </div>
    </div>
  </div>
</div>